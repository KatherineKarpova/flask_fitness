{% extends "layout.html" %}

{% block title %}
    Register
{% endblock %}

{% block main %}
<form action='/' method='post'>
    <button type="button" id="create-routine">Create Routine</button>
    <div id="create-routine-container"></div>
    <!-- Dynamic fields for exercises and sets -->
    <div id="add-exercise-container">
        <!-- Initial exercise and set fields will be displayed here -->
    </div>
    <!-- Submit button -->
    <button type="submit">Submit Routine</button>
</form>

<script>
document.getElementById("create-routine").addEventListener("click", function() {
    const routineContainer = document.getElementById("create-routine-container");

    if (routineContainer) {
        // Create a new div for the routine entry
        const routineDiv = document.createElement("div");

        // Add input for the routine name to the routineDiv
        routineDiv.innerHTML = `<label for="routine-name">Routine Name</label>`
        addInput("routine", "routine name", routineDiv, "exercise-input");

        // Create the "Add Exercise" button
        const addExerciseButton = document.createElement("button");
        addExerciseButton.textContent = "Add Exercise";  // Set button text
        addExerciseButton.id = "add-exercise";  // Optionally, give it an ID for styling
        addExerciseButton.type = "button";  // Prevent form submission on click

        // Append the Add Exercise button to the routineDiv
        routineDiv.appendChild(addExerciseButton);

        // Append the new routineDiv to the container
        routineContainer.appendChild(routineDiv);

        // Attach the event listener for "Add Exercise" after it's added to the DOM
        addExerciseButton.addEventListener("click", function() {
            const exerciseContainer = document.getElementById("add-exercise-container");
            
            if (exerciseContainer) {
                // Create a new div for the exercise entry
                const newExerciseDiv = document.createElement("div");
                newExerciseDiv.classList.add("exercise-entry");

                // Add exercise inputs (e.g., exercise name, sets)
                addExercise(newExerciseDiv).then(() => {
                    // After populating the exercise datalist, add input for sets
                    addInput("sets", "sets", newExerciseDiv, "short-input");
                    // Append the new exercise div to the container
                    exerciseContainer.appendChild(newExerciseDiv);
                }).catch(error => {
                    console.error('Error fetching exercise data:', error);
                });
            }
        });
    }
});

</script>

{% endblock %}
